<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport"content="width=device-width, initial-scale=1.0"><title>Encrypt/Decrypt Article</title><style>#zekiEncryptSystem{border:1px dashed black;padding:10px;max-width:800px;margin:0 auto;box-sizing:border-box}</style><script type="text/javascript"src="./zekiencryption.js"></script></head><body><div id="zekiEncryptSystem"><style>html{font-family:monospace}section{text-align:center;margin-bottom:15px}.title{font-weight:bold}.content{display:flex;justify-content:space-between}#articleKey,#keyTip{width:45%}#plainText,#cipherText,#encryptHTMLCode,#embedHTMLTest{width:100%}#articleKey,#keyTip,#plainText,#cipherText,#encryptHTMLCode{box-sizing:border-box}#articleKey,#keyTip{background-color:lightyellow}#plainText{background-color:rgb(145 238 145/50%)}#cipherText{background-color:rgb(240 128 128/50%)}#encryptHTMLCode{background-color:rgb(176 196 222/50%)}#embedHTMLTest{border:1px dotted black;text-align:left;min-height:100px}</style><script type="text/javascript">const generateIV=e=>{const t="AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789";let r="";for(let n=0;n<e;n++){let e;r+=t[Math.floor(62*Math.random())]}const n=(new TextEncoder).encode(r);return n},createCryptoKey=async(e,t)=>{const r=await window.crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e)),n=new Uint8Array(r),c=await window.crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!1,[t]);return c},encrypt=async()=>{const e=document.querySelector("#plainText").value;if(!e)return void alert("沒有可加密的明文！ 請在上面的欄位中輸入或貼上明文。");const t=document.querySelector("#articleKey").value;if(!t)return void alert("請輸入用於加密訊息的密鑰。");const r=document.querySelector("#keyTip").value,n=await createCryptoKey(t,"encrypt"),c=generateIV(10),o=(new TextDecoder).decode(c),a=(new TextEncoder).encode(e),i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c},n,a),d=btoa(String.fromCharCode(...c,...new Uint8Array(i))),l=`<div id="${o}"title="${d}">\n\t<div class="encryptedTip">\n\t\t<div class="description">這篇文章受保護，請輸入密碼。</div>\n\t\t<div>提示:${r||"無"}</div>\n\t\t<div class="operating">\n\t\t\t<input type="password"><button onclick="decryptArticle('${o}')">送出</button>\n\t\t</div>\n\t</div>\n</div>`;document.querySelector("#cipherText").value=d,document.querySelector("#encryptHTMLCode").value=l,document.querySelector("#embedHTMLTest").innerHTML=l},decrypt=async()=>{const e=document.querySelector("#cipherText").value;if(!e)return void alert("沒有可解密的密文！ 請在上面的欄位中輸入或貼上密文。");const t=document.querySelector("#articleKey").value;if(!t)return void alert("請輸入用於解密訊息的密鑰。");const r=await createCryptoKey(t,"decrypt"),n=new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0))),c=n.slice(0,10),o=n.slice(10),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:c},r,o),i=(new TextDecoder).decode(a);document.querySelector("#plainText").value=i},copyHTMLCode=()=>{var e=document.getElementById("encryptHTMLCode");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value)};</script><section><div class="title">Key</div><div class="content"><input type="text"id="articleKey"value=""placeholder="請輸入文章密碼"><input type="text"id="keyTip"value=""placeholder="密碼提示(預設無)"></div></section><section><div class="title">Plain Text</div><div class="content"><textarea id="plainText"cols="35"rows="5"></textarea><button onclick="encrypt()">Encrypt</button></div></section><section><div class="title">Cipher Text</div><div class="content"><textarea id="cipherText"cols="35"rows="5"></textarea><button onclick="decrypt()">Decrypt</button></div></section><section><div class="title">HTML Code</div><div class="content"><textarea id="encryptHTMLCode"cols="35"rows="10"></textarea><button onclick="copyHTMLCode()">Copy</button></div></section><section><div class="title">HTML Test</div><div class="content"><div id="embedHTMLTest"></div></div></section></div></body></html>